generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Admin {
    id              Int @id @default(autoincrement())
    username        String @unique
    email           String @unique
    password        String 
    role            AdminRole @default(NEWS_ADMIN)
    phoneNumber     String?
    isActive        Boolean @default(true)
    createdAt       DateTime @default(now())
    updatedAt       DateTime @updatedAt
    createdBy       Int?
    creator         Admin?  @relation("AdminCreator", fields: [createdBy], references: [id])
    createdAdmins   Admin[] @relation("AdminCreator")

    apiToken        String? @unique

    @@map("Admin")
}

enum AdminRole {
    SUPER_ADMIN
    NEWS_ADMIN
    TNTT_ADMIN
    BIBLE_ADMIN
}

model Category {
    id              Int @id @default(autoincrement())
    name            String
    slug            String @unique

    news            News[]
    tntt            TNTT[]
    bibleReadings   BibleReading[]
    liturgicalYears LiturgicalYear[]
}

model LiturgicalYear {
    id              Int @id @default(autoincrement())
    name            String // Ví dụ: "Năm phụng vụ A - 2025"
    code            String // A, B, C
    year            Int // 2025
    isFeatured      Boolean @default(false)
    imageUrl        String?
    description     String?
    title           String?

    readings        BibleReading[]
    news            News[]

    categoryId      Int
    category        Category @relation(fields: [categoryId], references: [id])
}

model News {
    id              Int @id @default(autoincrement())
    title           String
    slug            String? @unique 
    content         String 
    thumbnail       String?
    categoryId      Int
    liturgicalYearId Int?
    isFeatured       Boolean @default(false)

    category        Category @relation(fields: [categoryId], references: [id])
    liturgicalYear LiturgicalYear? @relation(fields: [liturgicalYearId], references: [id])

    createdAt       DateTime @default(now())
    updatedAt       DateTime @updatedAt
}

model TNTT {
    id              Int @id @default(autoincrement())
    title           String
    slug            String? @unique
    description     String?
    thumbnail       String?
    isFeatured       Boolean @default(false)

    categoryId      Int
    category        Category @relation(fields: [categoryId], references: [id])

    createdAt       DateTime @default(now())
    updatedAt       DateTime @updatedAt
}

model BibleReading {
    id              Int @id @default(autoincrement())
    title           String
    slug            String? @unique
    scripture       String // Ví dụ: Ga 3, 16-18
    reading1        String?
    reading2        String?
    psalm           String?
    alleluia        String?
    gospel          String
    liturgicalYearId Int
    thumbnail       String?

    liturgicalYear LiturgicalYear @relation(fields: [liturgicalYearId], references: [id])
    categoryId      Int
    category        Category @relation(fields: [categoryId], references: [id])
}